# KimuntuPro AI - Database Schema Documentation

## Overview
This document outlines the database schema for the KimuntuPro AI application using Firebase Firestore.

## Authentication
User authentication is handled by Firebase Authentication with support for:
- Email/Password authentication
- Google OAuth authentication

## Firestore Collections

### 1. innovativeProjects
Stores all innovative track projects created by users.

**Collection Path:** `/innovativeProjects`

#### Schema

```javascript
{
  // Document ID (auto-generated by Firestore)
  id: string,

  // User reference
  userId: string,  // Reference to Firebase Auth user ID

  // Project details
  title: string,
  description: string,
  category: string,  // Values: 'ai-ml', 'blockchain', 'iot', 'saas', 'fintech', 'other'
  status: string,    // Values: 'ideation', 'planning', 'development', 'testing', 'launch'

  // Project planning
  goals: string,
  challenges: string,
  resources: string,

  // Timestamps
  createdAt: Timestamp,
  updatedAt: Timestamp
}
```

#### Indexes
- `userId` (Ascending) + `createdAt` (Descending)
- `userId` (Ascending) + `category` (Ascending) + `createdAt` (Descending)
- `userId` (Ascending) + `status` (Ascending) + `createdAt` (Descending)

#### Security Rules

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Innovative Projects
    match /innovativeProjects/{projectId} {
      // Users can read their own projects
      allow read: if request.auth != null && resource.data.userId == request.auth.uid;

      // Users can create projects with their own userId
      allow create: if request.auth != null && request.resource.data.userId == request.auth.uid;

      // Users can update their own projects
      allow update: if request.auth != null && resource.data.userId == request.auth.uid;

      // Users can delete their own projects
      allow delete: if request.auth != null && resource.data.userId == request.auth.uid;
    }
  }
}
```

---

### 2. users (Future Implementation)
User profile and settings collection.

**Collection Path:** `/users`

#### Schema

```javascript
{
  // Document ID (matches Firebase Auth UID)
  id: string,

  // User information
  email: string,
  displayName: string,
  photoURL: string,

  // Profile details
  profession: string,
  industry: string,
  experience: string,

  // Settings
  preferences: {
    theme: string,  // 'light' or 'dark'
    notifications: boolean,
    emailUpdates: boolean
  },

  // Subscription
  subscriptionTier: string,  // 'free', 'pro', 'enterprise'
  subscriptionStatus: string,  // 'active', 'inactive', 'trial'

  // Timestamps
  createdAt: Timestamp,
  updatedAt: Timestamp,
  lastLoginAt: Timestamp
}
```

---

### 3. careerDocuments (Future Implementation)
Career track documents (CVs, resumes, cover letters).

**Collection Path:** `/careerDocuments`

#### Schema

```javascript
{
  id: string,
  userId: string,

  // Document details
  type: string,  // 'cv', 'resume', 'coverLetter', 'portfolio'
  title: string,
  content: object,  // Structured document content

  // Metadata
  industry: string,
  jobTitle: string,
  skills: array<string>,

  // Version control
  version: number,
  isTemplate: boolean,

  // Timestamps
  createdAt: Timestamp,
  updatedAt: Timestamp
}
```

---

### 4. businessPlans (Future Implementation)
Business track documents and plans.

**Collection Path:** `/businessPlans`

#### Schema

```javascript
{
  id: string,
  userId: string,

  // Business details
  businessName: string,
  industry: string,
  description: string,

  // Plan sections
  executiveSummary: string,
  marketAnalysis: object,
  financialProjections: object,
  marketingStrategy: object,
  operationalPlan: object,

  // Metadata
  status: string,  // 'draft', 'review', 'final'
  version: number,

  // Timestamps
  createdAt: Timestamp,
  updatedAt: Timestamp
}
```

---

### 5. legalDocuments (Future Implementation)
Legal track documents and templates.

**Collection Path:** `/legalDocuments`

#### Schema

```javascript
{
  id: string,
  userId: string,

  // Document details
  type: string,  // 'contract', 'agreement', 'nda', 'terms', 'policy'
  title: string,
  content: string,

  // Legal metadata
  jurisdiction: string,
  category: string,
  parties: array<object>,

  // Review status
  status: string,  // 'draft', 'review', 'signed', 'archived'
  reviewedBy: string,  // AI review status

  // Timestamps
  createdAt: Timestamp,
  updatedAt: Timestamp,
  signedAt: Timestamp
}
```

---

### 6. aiInteractions (Future Implementation)
Track AI interactions for analytics and improvement.

**Collection Path:** `/aiInteractions`

#### Schema

```javascript
{
  id: string,
  userId: string,

  // Interaction details
  type: string,  // 'career', 'business', 'legal', 'innovative'
  action: string,  // 'generate', 'analyze', 'review', 'suggest'

  // Input/Output
  input: string,
  output: string,

  // Metadata
  model: string,
  tokens: number,
  duration: number,

  // Quality metrics
  userRating: number,
  feedback: string,

  // Timestamps
  createdAt: Timestamp
}
```

---

## Data Flow

### Innovative Track Flow

1. **User Authentication**
   - User signs in via Firebase Auth
   - User ID is stored in session

2. **Create Project**
   - User fills out project form
   - Data is validated on client
   - `saveProject()` is called
   - Document is created in `innovativeProjects` collection
   - Project ID is returned

3. **View Projects**
   - `getUserProjects()` is called with user ID
   - Query filters by `userId`
   - Results are ordered by `createdAt` descending
   - Projects are displayed in UI

4. **Update Project**
   - User modifies project
   - `updateProject()` is called with project ID and updates
   - `updatedAt` timestamp is refreshed
   - UI is updated

5. **Delete Project**
   - User confirms deletion
   - `deleteProject()` is called with project ID
   - Document is removed from Firestore
   - UI is refreshed

---

## Future Enhancements

### Planned Features

1. **Real-time Collaboration**
   - Add `collaborators` array to projects
   - Implement real-time updates using Firestore listeners
   - Add activity logs for team members

2. **File Storage**
   - Integrate Firebase Storage for document uploads
   - Store file references in documents
   - Implement version control for files

3. **Analytics**
   - Track user engagement metrics
   - Monitor AI usage patterns
   - Generate insights dashboards

4. **Search & Filters**
   - Implement full-text search using Algolia or similar
   - Add advanced filtering options
   - Create saved searches

5. **Notifications**
   - Implement Firebase Cloud Messaging
   - Send project updates and reminders
   - Email notifications for important events

---

## Migration Scripts

### Initial Setup

To initialize the database with proper indexes, run these commands in Firebase Console:

```bash
# Create composite index for user projects
firebase firestore:indexes:create \
  --collection-group=innovativeProjects \
  --field=userId,asc \
  --field=createdAt,desc

# Create composite index for category filtering
firebase firestore:indexes:create \
  --collection-group=innovativeProjects \
  --field=userId,asc \
  --field=category,asc \
  --field=createdAt,desc

# Create composite index for status filtering
firebase firestore:indexes:create \
  --collection-group=innovativeProjects \
  --field=userId,asc \
  --field=status,asc \
  --field=createdAt,desc
```

---

## Backup & Recovery

### Backup Strategy

1. **Automated Daily Backups**
   - Schedule daily exports to Cloud Storage
   - Retain backups for 30 days
   - Store in geographically redundant locations

2. **Point-in-Time Recovery**
   - Enable Firestore PITR (Point-in-Time Recovery)
   - Allows restoration to any point within retention period

3. **Manual Exports**
   - Export data before major updates
   - Keep critical project backups locally

---

## Performance Optimization

### Best Practices

1. **Query Optimization**
   - Use composite indexes for complex queries
   - Limit query results with pagination
   - Cache frequently accessed data on client

2. **Data Structure**
   - Denormalize data when appropriate
   - Avoid deep nesting (max 3 levels)
   - Keep documents under 1MB

3. **Security**
   - Implement proper security rules
   - Validate data on both client and server
   - Use Cloud Functions for sensitive operations

---

## Monitoring

### Key Metrics to Track

1. **Usage Metrics**
   - Number of projects created per day
   - Active users per day/week/month
   - Feature adoption rates

2. **Performance Metrics**
   - Query response times
   - Document read/write counts
   - Error rates

3. **Cost Metrics**
   - Firestore operations count
   - Storage usage
   - Bandwidth usage

---

Last Updated: 2025-11-11
Version: 1.0.0
